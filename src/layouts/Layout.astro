---
import { siteConfig } from '../config/site';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

interface Props {
  title?: string;
  description?: string;
  canonical?: string;
  ogImage?: string;
  noindex?: boolean;
}

const { 
  title = siteConfig.title, 
  description = siteConfig.description,
  canonical = Astro.url.href,
  ogImage = '/images/og-digidms.png',
  noindex = false
} = Astro.props;

// Schema.org Organization
const organizationSchema = {
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "DigiDMS",
  "legalName": siteConfig.company.name,
  "url": siteConfig.url,
  "logo": `${siteConfig.url}/images/logo_full.png`,
  "description": "Managed Dokumentenmanagement für den deutschen Mittelstand",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": siteConfig.company.street,
    "addressLocality": "Wuppertal",
    "postalCode": "42117",
    "addressCountry": "DE"
  },
  "contactPoint": {
    "@type": "ContactPoint",
    "telephone": siteConfig.company.phone,
    "contactType": "sales",
    "availableLanguage": "German"
  },
  "sameAs": []
};

// Schema.org WebSite
const websiteSchema = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "DigiDMS",
  "url": siteConfig.url,
  "description": siteConfig.description,
  "publisher": {
    "@type": "Organization",
    "name": "DigiDMS"
  }
};
---

<!DOCTYPE html>
<html lang="de" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content={description} />
  <meta name="robots" content={noindex ? "noindex, nofollow" : "index, follow"} />
  <meta name="author" content="Digital Dimension IT GmbH" />
  <meta name="geo.region" content="DE-NW" />
  <meta name="geo.placename" content="Essen" />
  
  <!-- Canonical URL -->
  <link rel="canonical" href={canonical} />
  
  <!-- Open Graph -->
  <meta property="og:title" content={title} />
  <meta property="og:description" content={description} />
  <meta property="og:type" content="website" />
  <meta property="og:url" content={canonical} />
  <meta property="og:locale" content="de_DE" />
  <meta property="og:site_name" content="DigiDMS" />
  <meta property="og:image" content={`${siteConfig.url}${ogImage}`} />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="DigiDMS - Dokumentenmanagement für den Mittelstand" />
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content={title} />
  <meta name="twitter:description" content={description} />
  <meta name="twitter:image" content={`${siteConfig.url}${ogImage}`} />
  
  <!-- Schema.org JSON-LD -->
  <script type="application/ld+json" set:html={JSON.stringify(organizationSchema)} />
  <script type="application/ld+json" set:html={JSON.stringify(websiteSchema)} />
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/images/logo-icon.svg" />
  <link rel="apple-touch-icon" href="/images/DD_Logo_Icon-single1.png" />
  
  <!-- Lokale Inter Font -->
  <link rel="preload" href="/fonts/Inter-VariableFont_opsz,wght.woff2" as="font" type="font/woff2" crossorigin />

  <!-- Matomo Analytics (cookiefrei, selbst gehostet) -->
  <script is:inline>
    var _paq = window._paq = window._paq || [];
    _paq.push(['disableCookies']);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
      var u="https://s.digidim.de/";
      _paq.push(['setTrackerUrl', u+'matomo.php']);
      _paq.push(['setSiteId', '2']);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
    })();
  </script>

  <title>{title}</title>
</head>
<body class="min-h-screen flex flex-col bg-white text-gray-900 antialiased">
  <Header />
  
  <main class="flex-grow">
    <slot />
  </main>
  
  <Footer />
</body>
</html>

<style is:global>
  @tailwind base;
  @tailwind components;
  @tailwind utilities;

  @font-face {
    font-family: 'Inter';
    src: url('/fonts/Inter-VariableFont_opsz,wght.woff2') format('woff2');
    font-weight: 100 900;
    font-style: normal;
    font-display: swap;
  }

  @layer base {
    html {
      font-family: 'Inter', system-ui, sans-serif;
    }
    
    body {
      @apply text-gray-900 bg-white;
    }
  }

  @layer components {
    .btn {
      @apply inline-flex items-center justify-center px-6 py-3 font-semibold rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2;
    }
    
    .btn-primary {
      @apply btn bg-gradient-to-r from-secondary-600 to-primary-500 text-white hover:from-secondary-700 hover:to-primary-600 focus:ring-primary-500 shadow-lg hover:shadow-xl;
    }
    
    .btn-secondary {
      @apply btn bg-white text-navy border-2 border-gray-200 hover:border-primary-300 hover:bg-gray-50 focus:ring-primary-500;
    }
    
    .btn-outline {
      @apply btn border-2 border-white text-white hover:bg-white hover:text-navy focus:ring-white;
    }

    .section {
      @apply py-16 md:py-24;
    }

    .container-narrow {
      @apply max-w-4xl mx-auto px-4 sm:px-6 lg:px-8;
    }

    .container-wide {
      @apply max-w-7xl mx-auto px-4 sm:px-6 lg:px-8;
    }

    .gradient-text {
      @apply bg-clip-text text-transparent bg-gradient-to-r from-secondary-600 to-primary-500;
    }

    .card {
      @apply bg-white rounded-2xl shadow-lg border border-gray-100 p-6 transition-all duration-200 hover:shadow-xl hover:border-primary-200;
    }
  }
</style>
