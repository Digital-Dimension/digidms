---
/**
 * BreadcrumbNav.astro - Breadcrumb Navigation mit Schema.org
 *
 * @usage
 * <BreadcrumbNav
 *   items={[
 *     { label: 'Branchen', href: '/branchen' },
 *     { label: 'Handwerk' }
 *   ]}
 * />
 */

import { siteConfig } from '../config/site';

export interface BreadcrumbItem {
  label: string;
  href?: string;
}

export interface Props {
  items: BreadcrumbItem[];
  variant?: 'default' | 'light' | 'dark';
}

const { items, variant = 'default' } = Astro.props;

const siteUrl = siteConfig.url;

const breadcrumbSchema = {
  '@context': 'https://schema.org',
  '@type': 'BreadcrumbList',
  itemListElement: [
    {
      '@type': 'ListItem',
      position: 1,
      name: 'Start',
      item: siteUrl,
    },
    ...items.map((item, index) => ({
      '@type': 'ListItem',
      position: index + 2,
      name: item.label,
      ...(item.href && { item: new URL(item.href, siteUrl).href }),
    })),
  ],
};

const textClasses = {
  default: 'text-gray-400',
  light: 'text-gray-300',
  dark: 'text-gray-300',
};

const linkClasses = {
  default: 'text-gray-500 hover:text-primary-600',
  light: 'text-gray-400 hover:text-primary-500',
  dark: 'text-gray-200 hover:text-white',
};

const currentClasses = {
  default: 'text-gray-900',
  light: 'text-gray-700',
  dark: 'text-white',
};
---

<nav aria-label="Breadcrumb" class="py-4">
  <ol class="flex flex-wrap items-center gap-2 text-sm">
    <li class="flex items-center">
      <a
        href="/"
        class:list={['transition-colors', linkClasses[variant]]}
      >
        Start
      </a>
    </li>

    <li aria-hidden="true" class={textClasses[variant]}>
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
      </svg>
    </li>

    {items.map((item, index) => (
      <>
        <li class="flex items-center">
          {item.href ? (
            <a
              href={item.href}
              class:list={['transition-colors', linkClasses[variant]]}
            >
              {item.label}
            </a>
          ) : (
            <span
              class:list={['font-medium', currentClasses[variant]]}
              aria-current="page"
            >
              {item.label}
            </span>
          )}
        </li>

        {index < items.length - 1 && (
          <li aria-hidden="true" class={textClasses[variant]}>
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
            </svg>
          </li>
        )}
      </>
    ))}
  </ol>
</nav>

<script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />
