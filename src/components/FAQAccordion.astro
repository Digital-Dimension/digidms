---
interface FAQItem {
  question: string;
  answer: string;
}

interface Props {
  items: FAQItem[];
  id?: string;
}

const { items, id = 'faq' } = Astro.props;
---

<div class="space-y-4" id={id}>
  {items.map((item, index) => (
    <div class="border border-gray-200 rounded-xl overflow-hidden">
      <button
        type="button"
        class="faq-trigger w-full px-6 py-4 text-left flex items-center justify-between gap-4 bg-white hover:bg-gray-50 transition-colors"
        aria-expanded="false"
        data-faq-id={`${id}-${index}`}
      >
        <span class="font-semibold text-navy pr-4">{item.question}</span>
        <svg 
          class="faq-icon w-5 h-5 text-gray-400 flex-shrink-0 transition-transform duration-200" 
          fill="none" 
          stroke="currentColor" 
          viewBox="0 0 24 24"
        >
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
        </svg>
      </button>
      <div 
        class="faq-content hidden px-6 pb-4 bg-gray-50"
        data-faq-content-id={`${id}-${index}`}
      >
        <p class="text-gray-600 leading-relaxed" set:html={item.answer} />
      </div>
    </div>
  ))}
</div>

<script>
  document.querySelectorAll('.faq-trigger').forEach((trigger) => {
    trigger.addEventListener('click', () => {
      const faqId = trigger.getAttribute('data-faq-id');
      const content = document.querySelector(`[data-faq-content-id="${faqId}"]`);
      const icon = trigger.querySelector('.faq-icon');
      const isExpanded = trigger.getAttribute('aria-expanded') === 'true';
      
      // Toggle current item
      trigger.setAttribute('aria-expanded', (!isExpanded).toString());
      content?.classList.toggle('hidden');
      icon?.classList.toggle('rotate-180');
    });
  });
</script>
